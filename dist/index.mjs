import b from"path";import{sys as l,findConfigFile as J,readConfigFile as K,parseJsonConfigFileContent as U,DiagnosticCategory as V}from"typescript";import B from"aggregate-error";import{ModuleKind as T,ModuleResolutionKind as I,JsxEmit as w,ImportsNotUsedAsValues as F,NewLineKind as x,ScriptTarget as R,getEmitScriptTarget as E,getEmitModuleKind as h,getEmitModuleResolutionKind as S,getESModuleInterop as j,getAllowSyntheticDefaultImports as k,shouldPreserveConstEnums as m,getStrictOptionValue as a,getUseDefineForClassFields as N,getEffectiveTypeRoots as A,getAutomaticTypeDirectiveNames as v,createCompilerHost as M}from"typescript";function D(e){var t,r,n,o,i,u,f;e.target=E(e),e.useDefineForClassFields=N(e),e.module=h(e),e.moduleResolution=S(e),e.esModuleInterop=j(e),e.allowSyntheticDefaultImports=k(e),e.declaration=(t=e.declaration)!=null?t:e.composite,e.incremental=(r=e.incremental)!=null?r:e.composite,e.preserveConstEnums=m(e),e.reactNamespace=(n=e.reactNamespace)!=null?n:"React",e.jsxFactory=(o=e.jsxFactory)!=null?o:`${e.reactNamespace}.createElement`,e.jsxImportSource=(i=e.jsxImportSource)!=null?i:"react",e.generateCpuProfile=(u=e.generateCpuProfile)!=null?u:"profile.cpuprofile",e.tsBuildInfoFile=(f=e.tsBuildInfoFile)!=null?f:".tsbuildinfo",e.alwaysStrict=a(e,"alwaysStrict"),e.strictNullChecks=a(e,"strictNullChecks"),e.strictBindCallApply=a(e,"strictBindCallApply"),e.strictFunctionTypes=a(e,"strictFunctionTypes"),e.strictPropertyInitialization=a(e,"strictPropertyInitialization"),e.noImplicitAny=a(e,"noImplicitAny"),e.noImplicitThis=a(e,"noImplicitThis"),e.useUnknownInCatchVariables=a(e,"useUnknownInCatchVariables");let s=M(e);e.typeRoots=A(e,s),e.types=v(e,s)}var d={importsNotUsedAsValues:F,jsx:w,module:T,moduleResolution:I,newLine:x,target:R};function y(e=!1){var r;let s={},t={};if(this.parsed){let{raw:n,options:o}=this.parsed;Object.assign(t,n),Object.assign(s,o),delete s.configFilePath}e&&D(s);for(let n in d){let o=d[n];n in s&&(s[n]=o[s[n]])}return delete t.extends,Object.keys(s).length>0&&(t.compilerOptions=s),t.include=(r=t.include)!=null?r:t.files?[]:["**/*"],t}var L=18003,g=new Map;function z(e=process.cwd()){var i;let s=g.get(e);if(s)return s;let t=e.endsWith(".json")?e:J(e,l.fileExists,"tsconfig.json"),r;if(t){if(s=g.get(t),s)return s;if(r=K(t,l.readFile),(i=r.error)==null?void 0:i.messageText)throw new Error(r.error.messageText.toString())}let n=U(r?r.config:{},l,b.dirname(t||e));if(n.errors.length>0){let u=n.errors.filter(f=>{if(!(!t&&f.code===L))return f.category===V.Error});if(u.length>0)throw new B(u.map(f=>f.messageText))}let o={path:t,parsed:n,getRaw:y};return g.set(e,o),t&&t!==e&&g.set(t,o),o}var G=z;export{G as default};
